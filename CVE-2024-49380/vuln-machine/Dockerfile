FROM ubuntu:25.04 as RUNTIME
MAINTAINER "ahmetak4n <ahmetak4n@gmail.com>"

WORKDIR /app

# Update & Install Dependencies
RUN apt-get update && apt-get install -y openssh-server supervisor

RUN echo PORT 2222 >> /etc/ssh/sshd_config

# Install Plenti
COPY plenti_0.7.1_linux_64-bit.tar.gz /app/plenti_0.7.1_linux_64-bit.tar.gz
RUN tar -xvf plenti_0.7.1_linux_64-bit.tar.gz -C /usr/local/bin

# Create a new Plenti site
RUN plenti new site vulnerability-demo

# Copy supervisord config to container
COPY supervisord.conf /etc/supervisor/conf.d/supervisord.conf

EXPOSE 2222 3000

CMD ["/usr/bin/supervisord"]
